# 工場設備管理システム - 要件定義書

## 1. 機能要件

### 1.1 アプリケーション開発の目的や背景

#### 開発目的
工場の設備管理における以下の課題を解決し、効率的な運用を実現するシステムを構築する：

**解決すべき課題：**
- **監視対象の多様性と複雑さ**: 多くの生産設備を同時に監視する必要があり、異常やトラブルの発生原因が多岐にわたる
- **人的リソースの制約**: 専門知識を持ったスタッフが不足し、効率的な運用が実現できない
- **データ活用の困難さ**: 設備データの統合・分析が困難で、異常やトラブルの早期発見が難しい

#### 期待される効果
- 設備ダウンタイム：20%削減
- メンテナンス効率：30%向上  
- 運用コスト：15%削減
- 設備稼働率：38%向上（実績ベース）

#### ビジネス価値
リアルタイム監視システム導入により稼働率を38%向上させた実績や、予知保全システムにより設備故障率を10-15%削減した実績を参考に、工場の生産性向上とコスト削減を実現する。

### 1.2 対象ユーザーや利用シーン

#### 対象ユーザー（アクター）

| ユーザー種別 | 役割 | 利用シーン | 主要な利用機能 |
|-------------|------|-----------|---------------|
| **設備オペレーター** | 日常的な設備監視・操作 | - 勤務時間中の監視業務<br>- 異常発生時の初期対応<br>- 設備状況の確認 | - リアルタイム監視ダッシュボード<br>- アラート確認・対応<br>- 設備稼働状況確認 |
| **メンテナンス技術者** | 設備保守・修理 | - 定期メンテナンス実施<br>- 故障対応<br>- 予防保全計画立案 | - メンテナンス計画策定<br>- 作業実行管理<br>- 履歴管理・分析 |
| **生産管理者** | 生産計画・設備稼働管理 | - 生産計画立案<br>- 設備効率分析<br>- 投資判断 | - 稼働分析レポート<br>- KPI監視<br>- 改善提案確認 |
| **保全管理者** | メンテナンス戦略立案 | - 年間保全計画策定<br>- 予算管理<br>- 戦略的意思決定 | - 全体分析レポート<br>- 予算・計画管理<br>- ROI分析 |
| **システム管理者** | システム運用・保守 | - システム監視<br>- ユーザー管理<br>- セキュリティ管理 | - システム監視<br>- ユーザー権限管理<br>- ログ管理 |

#### 利用環境
- **主要利用場所**: 工場内制御室、現場、事務所
- **利用デバイス**: PC、タブレット、スマートフォン
- **利用時間**: 24時間365日（シフト制での監視体制）

### 1.3 主要な機能やサービス

#### 1.3.1 リアルタイム設備監視機能
**機能概要**: 工場内の全設備をリアルタイムで監視し、異常を早期発見する

**詳細機能**:
- センサーデータのリアルタイム収集・表示（温度、振動、圧力、電流値）
- 設備稼働状況の可視化（稼働中/停止中/異常）
- 閾値を超えた場合の自動アラート通知
- 設備稼働時間と効率指標の表示
- 異常発生時の影響範囲評価

**技術要件**:
- データ更新間隔：1秒以内
- 同時監視可能設備数：1000台
- アラート通知方式：メール、画面通知、音声アラート

#### 1.3.2 予知保全計画策定機能
**機能概要**: 設備データを分析し、効率的な予防保全計画を策定する

**詳細機能**:
- AI分析による設備劣化傾向の検知
- 故障予測時期の算出
- 最適なメンテナンススケジュールの提案
- 部品交換時期の予測
- メンテナンス計画の自動生成

**技術要件**:
- 機械学習モデルによる予測精度：85%以上
- 予測期間：3ヶ月先まで
- データ分析周期：日次バッチ処理

#### 1.3.3 メンテナンス実行管理機能
**機能概要**: 計画されたメンテナンス作業を管理し、結果を記録する

**詳細機能**:
- メンテナンス作業スケジュール管理
- 作業チェックリストの提供
- 作業時間・内容の記録
- 交換部品の管理
- 作業完了確認とサインオフ
- 次回メンテナンス計画の自動更新

#### 1.3.4 設備稼働分析・レポート機能
**機能概要**: 設備の稼働データを分析し、運用改善提案を提供する

**詳細機能**:
- 稼働率・効率指標の分析
- ボトルネック設備の特定
- 最適化提案の生成
- Power BIによるインタラクティブレポート
- KPI指標の追跡・監視
- 日次・週次・月次レポートの自動生成

#### 1.3.5 緊急事態対応機能
**機能概要**: 設備緊急事態発生時の対応フローを管理する

**詳細機能**:
- 緊急アラートの自動発信
- 緊急停止手順の表示
- 関係者への自動通知
- 対応履歴の記録
- 事故報告書の作成支援

### 1.4 画面や操作

#### 1.4.1 メイン画面構成

**ダッシュボード画面**:
- 全設備の稼働状況を一覧表示
- リアルタイムセンサーデータの表示
- アラート・通知エリア
- KPI指標の表示

**設備詳細画面**:
- 個別設備の詳細情報表示
- センサーデータのグラフ表示
- メンテナンス履歴
- 予測情報

**メンテナンス管理画面**:
- 作業スケジュール表示
- 作業指示書の表示・編集
- 進捗状況の更新
- 完了報告の入力

**分析・レポート画面**:
- Power BI埋め込みダッシュボード
- フィルタリング・ドリルダウン機能
- レポートのエクスポート機能

#### 1.4.2 操作方式
- **レスポンシブデザイン**: PC・タブレット・スマートフォン対応
- **直感的操作**: ドラッグ&ドロップ、タッチ操作対応
- **アクセシビリティ**: WCAG2.1 AA準拠

### 1.5 外部サービスとのやり取り

#### 1.5.1 IoTセンサーとの連携
- **データ収集**: MQTTプロトコルによるセンサーデータ受信
- **通信方式**: HTTP、WebSocket、MQTT
- **データ形式**: JSON形式
- **データ頻度**: 1秒間隔での連続データ受信

#### 1.5.2 Azure クラウドサービス連携
- **Azure Cosmos DB**: センサーデータの高速書き込み・読み込み
- **Azure SQL Database**: マスターデータ・分析結果の格納
- **Azure Functions**: データ処理・分析ロジックの実行
- **Power BI**: ビジネスインテリジェンス・レポート作成

#### 1.5.3 通知サービス連携
- **メール通知**: SMTP経由でのアラートメール送信
- **SMS通知**: Twilio等のサービス連携
- **チャット通知**: Teams、Slack等への通知連携

### 1.6 他のアプリケーションやサービスとの依存関係

#### 1.6.1 認証システム
- **Azure Active Directory**: 統合認証・シングルサインオン
- **依存関係**: ユーザー認証・認可の全面的依存
- **影響範囲**: 認証サービス停止時はシステム全体が利用不可

#### 1.6.2 ERP・生産管理システム
- **連携内容**: 生産計画データ、設備マスタ情報の同期
- **連携方式**: REST API、バッチファイル連携
- **データ同期頻度**: 日次バッチ処理

#### 1.6.3 既存監視システム
- **SCADA（監視制御システム）**: 既存制御システムとの部分連携
- **連携方式**: OPC UA、データベース連携
- **移行方針**: 段階的な機能移行

#### 1.6.4 保守管理システム
- **CMMS（設備保守管理システム）**: 既存保守記録との統合
- **連携内容**: メンテナンス履歴、部品在庫情報
- **データ移行**: 過去3年分の履歴データ移行

## 2. 非機能要件

### 2.1 可用性

#### 2.1.1 稼働率要件
- **目標稼働率**: 99.9%以上（年間ダウンタイム8.77時間以内）
- **営業時間稼働率**: 99.99%以上（平日8:00-18:00）
- **24時間365日運用**: 工場の連続稼働に対応

#### 2.1.2 バックアップ・復旧要件
- **自動バックアップ**: 日次自動フルバックアップ
- **データ保持期間**: 3年間のデータ保持
- **復旧時間目標（RTO）**: 4時間以内
- **復旧ポイント目標（RPO）**: 1時間以内
- **24時間365日復旧可能**: いつでも即座にデータ復旧可能

#### 2.1.3 冗長化・フェイルオーバー
- **データベース**: 自動フェイルオーバー機能
- **アプリケーション**: 複数インスタンスでの負荷分散
- **リージョン間バックアップ**: 災害対策用の別リージョンバックアップ

### 2.2 性能・拡張性

#### 2.2.1 応答性能要件
- **API応答時間**: 500ms以内（95%tile）
- **画面表示時間**: 3秒以内
- **リアルタイムデータ更新**: 1秒以内
- **レポート生成時間**: 30秒以内（通常レポート）

#### 2.2.2 スループット要件
- **同時接続ユーザー数**: 100名（現在の想定：10名程度）
- **データ処理能力**: 1000台の設備からの同時データ処理
- **API呼び出し**: 毎秒1000リクエスト処理可能

#### 2.2.3 拡張性要件
- **水平スケーリング**: 負荷に応じた自動スケール機能
- **機能拡張性**: 後から機能を追加可能な拡張アーキテクチャ
- **データ容量**: ペタバイト級データの処理・保存可能

### 2.3 運用・保守性

#### 2.3.1 監視・ログ要件
- **システム監視**: Application Insightsによる詳細監視
- **アプリケーションログ**: 構造化ログによる問題調査支援
- **アクセスログ**: 全操作の監査ログ記録
- **パフォーマンス監視**: リアルタイムパフォーマンス監視

#### 2.3.2 メンテナンス要件
- **メンテナンス時間**: 月1回、2時間以内の計画停止
- **緊急メンテナンス**: 30分以内での緊急対応可能
- **ローリング更新**: 無停止でのアプリケーション更新

#### 2.3.3 運用サポート
- **アラート機能**: 異常検知時の自動アラート
- **ダッシュボード**: 運用状況の可視化
- **自動復旧**: 軽微な障害の自動復旧機能

### 2.4 移行性

#### 2.4.1 既存システムからの移行
- **段階的移行**: 既存システムとの並行稼働期間を設定
- **データ移行**: 過去3年分の設備・メンテナンス履歴データ移行
- **ユーザー移行**: 段階的なユーザー移行とトレーニング

#### 2.4.2 移行計画
- **移行フェーズ1**: 新システム導入・並行稼働開始
- **移行フェーズ2**: 一部機能の段階的移行
- **移行フェーズ3**: 完全移行・旧システム停止

#### 2.4.3 ロールバック対応
- **緊急ロールバック**: 重大な問題発生時の即座のロールバック
- **データ整合性**: ロールバック時のデータ整合性保証

### 2.5 セキュリティ

#### 2.5.1 認証・認可
- **統合認証**: Azure Active Directory統合認証
- **多要素認証**: MFA（多要素認証）の必須化
- **ロールベースアクセス制御**: RBAC による詳細な権限管理
- **セッション管理**: 安全なセッション管理・タイムアウト

#### 2.5.2 データ保護
- **暗号化**: データの転送時・保存時暗号化（AES-256）
- **個人情報保護**: 厳密な個人情報管理（課金情報・個人データ）
- **データマスキング**: 本番以外の環境での機密データマスキング
- **アクセス制御**: 最小権限の原則に基づくアクセス制御

#### 2.5.3 セキュリティ対策
- **ネットワークセキュリティ**: ファイアウォール・WAF設定
- **脆弱性対策**: 定期的なセキュリティスキャン・アップデート
- **監査ログ**: 全操作の監査ログ記録・改ざん防止
- **インシデント対応**: セキュリティインシデント対応手順

### 2.6 環境・サステナビリティ

#### 2.6.1 環境負荷軽減
- **クラウドファースト**: 環境効率の高いAzureクラウドサービス活用
- **グリーンエネルギー**: 太陽光発電などの再生可能エネルギー利用環境での動作
- **省電力設計**: スマートフォンアプリケーションでの省電力設計

#### 2.6.2 サステナブル運用
- **ペーパーレス**: デジタル化による紙資源の削減
- **効率化**: システムによる運用効率化でエネルギー消費削減
- **リモート対応**: リモート監視・診断による移動コスト削減

#### 2.6.3 カーボンフットプリント削減
- **サーバーレスアーキテクチャ**: 必要時のみのリソース使用
- **最適化**: AI活用による設備運用最適化でエネルギー効率向上
- **長期利用**: 設備寿命延長による資源の有効活用

---

**タスクが完了しました**

この要件定義書では、既存のユースケース企画書とプロジェクト設計書から機能要件と非機能要件を抽出し、体系的に整理しました。また、ヒアリングドキュメントの内容も考慮して、特に非機能要件の可用性、セキュリティ、環境要件に反映させています。